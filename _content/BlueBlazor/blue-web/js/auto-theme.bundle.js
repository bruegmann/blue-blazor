(()=>{"use strict";var e={};function t(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.d=(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class r extends HTMLElement{constructor(){super(...arguments),t(this,"ancestorObservers",[]),t(this,"rafId",null)}static get observedAttributes(){return["dark-threshold"]}connectedCallback(){this.init()}disconnectedCallback(){this.cleanupObservers(),null!=this.rafId&&cancelAnimationFrame(this.rafId)}attributeChangedCallback(){this.scheduleUpdate()}init(){this.cleanupObservers(),this.observeAncestors(),this.updateTheme()}observeAncestors(){let e=this.parentElement;for(;e&&e!==document.documentElement;){const t=new MutationObserver(()=>this.scheduleUpdate());t.observe(e,{attributes:!0,attributeFilter:["class","style"]}),this.ancestorObservers.push(t),e=e.parentElement}[document.body,document.documentElement].forEach(e=>{if(!e)return;const t=new MutationObserver(()=>this.scheduleUpdate());t.observe(e,{attributes:!0,attributeFilter:["class","style"]}),this.ancestorObservers.push(t)})}cleanupObservers(){this.ancestorObservers.forEach(e=>e.disconnect()),this.ancestorObservers=[]}scheduleUpdate(){null==this.rafId&&(this.rafId=requestAnimationFrame(()=>{this.rafId=null,this.updateTheme()}))}getThreshold(){const e=parseFloat(this.getAttribute("dark-threshold")||"");return isNaN(e)?.5:Math.min(1,Math.max(0,e))}updateTheme(){const e=this.computeEffectiveBackground();e&&this.relativeLuminance(e.r,e.g,e.b)<this.getThreshold()?this.setAttribute("data-bs-theme","dark"):this.removeAttribute("data-bs-theme")}computeEffectiveBackground(){let e={r:0,g:0,b:0,a:0},t=this.parentElement;for(;t&&e.a<.999;){const r=getComputedStyle(t),s=this.parseColor(r.backgroundColor);s&&s.a>0&&(e=this.composite(s,e)),t=t.parentElement}if(e.a<.999){const t=this.parseColor(getComputedStyle(document.documentElement).backgroundColor)||this.parseColor(getComputedStyle(document.body).backgroundColor)||{r:255,g:255,b:255,a:1};e=this.composite(t,e)}return e}composite(e,t){const r=e.a+t.a*(1-e.a);return{r:(e.r*e.a+t.r*t.a*(1-e.a))/(r||1),g:(e.g*e.a+t.g*t.a*(1-e.a))/(r||1),b:(e.b*e.a+t.b*t.a*(1-e.a))/(r||1),a:r}}parseColor(e){if(!e)return null;const t=e.trim().match(/^rgba?\(\s*([\d.]+)[ ,]+([\d.]+)[ ,]+([\d.]+)(?:[ ,/]+([\d.]+))?\s*\)$/i);if(t)return{r:Number(t[1]),g:Number(t[2]),b:Number(t[3]),a:void 0!==t[4]?Number(t[4]):1};if("#"===e[0]){let t=e.slice(1);if(3===t.length&&(t=t.split("").map(e=>e+e).join("")),6===t.length||8===t.length)return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:8===t.length?parseInt(t.slice(6,8),16)/255:1}}return null}relativeLuminance(e,t,r){const s=e=>{const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)};return.2126*s(e)+.7152*s(t)+.0722*s(r)}}customElements.define("bl-auto-theme",r)})();